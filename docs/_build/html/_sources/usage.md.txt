# Usage

## Install and run with uv

```bash
uv venv
uv run mdkv --help
```

## Create a document

```bash
uv run mdkv init --title "Doc" --author "You" --out doc.mdkv
uv run mdkv info doc.mdkv
uv run mdkv validate doc.mdkv
uv run mdkv export doc.mdkv > out.md
uv run mdkv export --html doc.mdkv > out.html
```

## CLI utilities

```bash
# list tracks as JSON
uv run mdkv list-tracks doc.mdkv

# add a commentary track
uv run mdkv add-track doc.mdkv --id notes --type commentary --lang "" --content "Note"

# export selected track types as Markdown
uv run mdkv export-tracks doc.mdkv --types primary,commentary
```

## Python API (public surface)

```python
from datetime import datetime
from mdkv import (
  MDKVDocument, Track,
  save_mdkv, load_mdkv,
  validate_document,
  export_to_files,
)

Doc = MDKVDocument(title="T", authors=["A"], created=datetime.utcnow())
Doc.add_track(Track("primary", "primary", "en", "tracks/primary.md", "# Title\n\nText"))
Doc.list_languages()  # ["en"]

save_mdkv(Doc, "doc.mdkv")
loaded = load_mdkv("doc.mdkv")
validate_document(loaded)

# access and remove
track = loaded.get_track("primary")
removed = loaded.remove_track("primary")

# write each track to its own .md file
from pathlib import Path
export_to_files(loaded, Path("out_tracks"), include_track_types=["primary", "commentary"])
```

### From YAML definitions

The `library/definitions/` directory contains YAML examples you can convert to `.mdkv` using the included helper:

```python
from pathlib import Path
from mdkv.library import build_all_examples

build_all_examples(Path('library/definitions'), Path('library/_built'))
```

## Logging & workflows

- Configure logging with `mdkv.common.configure_logging()`.
- See `examples/logged_workflow.py` for an end-to-end script that logs steps and writes outputs to `workflow_out/`.

## GUI

Launch the local web GUI (two-pane editor/preview):

```bash
uv run mdkv gui --path doc.mdkv
# or with the convenience launcher
python3 run_gui.py --path doc.mdkv
```

In the GUI preview toolbar, use checkboxes to toggle which tracks are shown:
- All: renders all tracks.
- Custom: uncheck All and select any combination of tracks; the preview updates live. Selecting none shows an empty preview.

The editor pane always holds the full combined Markdown (round-trippable).
